#!/usr/bin/env bash
#
#

set -eu

remote_name="${1:-origin}"
base_branch="$(git base-branch)"

printutil section "Start sync..."

printutil subsection "Checkout $base_branch"
git checkout $base_branch

printutil subsection "Pull $base_branch from $remote_name"
git pull $remote_name $base_branch

printutil subsection "Remove references that no longer exist on the remote"
git fetch --prune $remote_name

printutil subsection "Cleanup merged branches in local"
git clean-branch local

printutil subsection "Cleanup merged branches in remote"
git clean-branch remote
